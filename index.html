<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>gigaDrop</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>
  <nav>gigaDrop</nav>
  <h1 id="h1">Click here or drop your files to share them.</h1>

  <aside>
    <div>Your are visible as:</div>
    <input type="text" id="myName" value="Felix">
  </aside>
  <div id="line"></div>

  <div class="trail" id="trail"></div>
  <div class="cursor-glow" id="glow"></div>
<script>
function updateLinePosition() {
    const h1 = document.querySelector("#h1");
    const line = document.querySelector("#line");

    if (h1 && line) {
        // Get width of #h1
        let h1Width = h1.offsetWidth;

        // Subtract total inline padding (left + right = 88px)
        let adjustedWidth = h1Width - (44 * 2);

        // Multiply by 1.05
        adjustedWidth *= 1.05;

        // Divide by 2
        let halfValue = adjustedWidth / 2;

        // Invert the value
        let finalValue = halfValue * -1;

        // Apply to #line as left position in px
        line.style.left = finalValue + "px";
    }
}

// Run on load
document.addEventListener("DOMContentLoaded", updateLinePosition);

// Run on resize for responsiveness
window.addEventListener("resize", updateLinePosition);
</script>

<script>
  const h1 = document.getElementById('h1');
const line = document.getElementById('line');

h1.addEventListener('mouseenter', () => {
  line.classList.add('line');
});

h1.addEventListener('mouseleave', () => {
  line.classList.remove('line');
});

</script>


<script>
  
  function getTextWidth(element) {
    const style = window.getComputedStyle(element);
    const paddingLeft = parseFloat(style.paddingLeft);
    const paddingRight = parseFloat(style.paddingRight);
    let textWidth = element.offsetWidth - paddingLeft - paddingRight;
    return textWidth * 1.05; // stretch by 5%
  }
  
  h1.addEventListener('mouseenter', () => {
    const targetWidth = getTextWidth(h1);
  
    line.style.setProperty('--target-width', `${targetWidth}px`);
    line.style.setProperty('--target-translate', `${targetWidth / 2}px`);
  
    line.classList.add('line');
  });
  
  h1.addEventListener('mouseleave', () => {
    line.classList.remove('line');
  });
  </script>
  
  <script>
    const GRID = 40;
    const LERP = 0.08;
    const SPEED_CAP = 1200;
    const TRAIL_SPAWN_DIST = 8;
    const TRAIL_LIFE = 600;
    
    const glow = document.getElementById('glow');
    const trailContainer = document.getElementById('trail');
    
    let targetX = window.innerWidth/2, targetY = window.innerHeight/2;
    let currentX = targetX, currentY = targetY;
    let lastMouseX = targetX, lastMouseY = targetY, lastTime = performance.now();
    let velocity = 0;
    let lastTrailX = targetX, lastTrailY = targetY;
    
    window.addEventListener('mousemove', (e) => {
      targetX = e.clientX;
      targetY = e.clientY;
    
      const now = performance.now();
      const dt = Math.max((now - lastTime)/1000, 0.001);
      const dx = e.clientX - lastMouseX;
      const dy = e.clientY - lastMouseY;
      const dist = Math.sqrt(dx*dx + dy*dy);
      velocity = dist / dt;
    
      lastMouseX = e.clientX; lastMouseY = e.clientY; lastTime = now;
    
      if (Math.hypot(targetX - lastTrailX, targetY - lastTrailY) > TRAIL_SPAWN_DIST) {
        spawnTrailDot(targetX, targetY, velocity);
        lastTrailX = targetX; lastTrailY = targetY;
      }
    });
    
    window.addEventListener('mousedown', (e) => {
      const flash = document.createElement('div');
      flash.className = 'click-flash';
      document.body.appendChild(flash);
      flash.style.left = (e.clientX) + 'px';
      flash.style.top  = (e.clientY) + 'px';
    
      requestAnimationFrame(() => {
        flash.style.transition = 'transform 260ms ease-out, opacity 260ms ease-out, width 260ms linear, height 260ms linear';
        flash.style.transform = 'translate(-50%,-50%) scale(3)';
        flash.style.opacity = '0';
        flash.style.width = '160px';
        flash.style.height = '160px';
      });
      setTimeout(() => flash.remove(), 300);
    });
    
    function spawnTrailDot(x, y, vel) {
      const d = document.createElement('div');
      d.className = 'trail-dot';
      const speedFactor = Math.min(vel / SPEED_CAP, 1);
      const size = 8 + speedFactor * 22;
      const opa = 0.45 + (1 - speedFactor) * 0.5;
    
      d.style.left = x + 'px';
      d.style.top = y + 'px';
      d.style.width = size + 'px';
      d.style.height = size + 'px';
      d.style.opacity = opa;
    
      trailContainer.appendChild(d);
    
      requestAnimationFrame(() => {
        d.style.transition = `opacity ${TRAIL_LIFE}ms linear, transform ${TRAIL_LIFE}ms linear, width ${TRAIL_LIFE}ms linear, height ${TRAIL_LIFE}ms linear`;
        d.style.transform = 'translate(-50%,-50%) scale(1.25)';
        d.style.opacity = '0';
        d.style.width = (size*1.5) + 'px';
        d.style.height = (size*1.5) + 'px';
      });
    
      setTimeout(() => { try{d.remove()}catch(e){} }, TRAIL_LIFE + 40);
    }
    
    let pulseT = 0;
    function animate(){
      currentX += (targetX - currentX) * LERP;
      currentY += (targetY - currentY) * LERP;
    
      const speedFactor = Math.min(velocity / SPEED_CAP, 1);
      const baseSize = 48;
      const size = baseSize + speedFactor * 40;
      const opacity = 0.22 + (1 - speedFactor) * 0.78;
      const glowPx = 60 + speedFactor * 120;
    
      if (speedFactor < 0.12) {
        pulseT += 0.04;
        const pulse = Math.sin(pulseT) * 4;
        glow.style.width = (size + pulse) + 'px';
        glow.style.height = (size + pulse) + 'px';
      } else {
        glow.style.width = size + 'px';
        glow.style.height = size + 'px';
      }
    
      glow.style.transform = `translate(${currentX}px, ${currentY}px) translate(-50%, -50%)`;
      glow.style.boxShadow = `0 0 ${glowPx}px rgba(255,255,255,${Math.max(0.25, opacity)}) , 0 0 ${Math.max(20, glowPx/2)}px rgba(255,255,255,${Math.max(0.12, opacity*0.8)})`;
      glow.style.opacity = opacity;
    
      velocity *= 0.92;
      requestAnimationFrame(animate);
    }
    
    animate();
    
    window.addEventListener('resize', () => {
      targetX = Math.min(targetX, window.innerWidth);
      targetY = Math.min(targetY, window.innerHeight);
    });
    </script>
    
</body>
</html>